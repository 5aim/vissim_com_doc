# This is the example to use Fixed Time by setting Base64-encoded text #

import os
import win32com.client as com
import base64

NUM_SG = 2

# Open Vissim and load Base model
Vissim = com.gencache.EnsureDispatch("Vissim.Vissim.23") #
path = os.getcwd()
Vissim.LoadNet(f'{path}\Base.inpx')

# Add Signal Controller and Groups
SC = Vissim.Net.SignalControllers.AddSignalController(0)
[SC.SGs.AddSignalGroup(0) for i in range(NUM_SG)]

# Convert file content to base64 encoded string
with open("2SGs.sig", "rb") as file:
    encoded = base64.encodebytes(file.read()).decode("utf-8")

# Set the internal supply data and (option) program number
SC.SetAttValue('IntSupplyData', encoded)
#SC.SetAttValue('IntSupplyData', 'PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzYyB2ZXJzaW9uPSIyMDIwMDEiIGlkPSIxIiBuYW1lPSIiIGZyZXF1ZW5jeT0iMSIgc3RlcHM9IjAiIGRlZmF1bHRJbnRlcmdyZWVuTWF0cml4PSIwIiBpbnRlcnN0YWdlc1VzaW5nTWluRHVyYXRpb25zPSJ0cnVlIiBjaGVja1N1bT0iNzAyMDIwMzc5Ij4NCiAgPHNpZ25hbGRpc3BsYXlzPg0KICAgIDxkaXNwbGF5IGlkPSIxIiBuYW1lPSJSZWQiIHN0YXRlPSJSRUQiPg0KICAgICAgPHBhdHRlcm5zPg0KICAgICAgICA8cGF0dGVybiBwYXR0ZXJuPSJNSU5VUyIgY29sb3I9IiNGRjAwMDAiIGlzQm9sZD0idHJ1ZSIgLz4NCiAgICAgIDwvcGF0dGVybnM+DQogICAgPC9kaXNwbGF5Pg0KICAgIDxkaXNwbGF5IGlkPSIzIiBuYW1lPSJHcmVlbiIgc3RhdGU9IkdSRUVOIj4NCiAgICAgIDxwYXR0ZXJucz4NCiAgICAgICAgPHBhdHRlcm4gcGF0dGVybj0iRlJBTUUiIGNvbG9yPSIjMDBDQzAwIiBpc0JvbGQ9InRydWUiIC8+DQogICAgICAgIDxwYXR0ZXJuIHBhdHRlcm49IlNPTElEIiBjb2xvcj0iIzAwQ0MwMCIgaXNCb2xkPSJmYWxzZSIgLz4NCiAgICAgIDwvcGF0dGVybnM+DQogICAgPC9kaXNwbGF5Pg0KICAgIDxkaXNwbGF5IGlkPSI0IiBuYW1lPSJBbWJlciIgc3RhdGU9IkFNQkVSIj4NCiAgICAgIDxwYXR0ZXJucz4NCiAgICAgICAgPHBhdHRlcm4gcGF0dGVybj0iRlJBTUUiIGNvbG9yPSIjQ0NDQzAwIiBpc0JvbGQ9InRydWUiIC8+DQogICAgICAgIDxwYXR0ZXJuIHBhdHRlcm49IlNMQVNIIiBjb2xvcj0iI0NDQ0MwMCIgaXNCb2xkPSJmYWxzZSIgLz4NCiAgICAgIDwvcGF0dGVybnM+DQogICAgPC9kaXNwbGF5Pg0KICA8L3NpZ25hbGRpc3BsYXlzPg0KICA8c2lnbmFsc2VxdWVuY2VzPg0KICAgIDxzaWduYWxzZXF1ZW5jZSBpZD0iNyIgbmFtZT0iUmVkLUdyZWVuLUFtYmVyIj4NCiAgICAgIDxzdGF0ZSBkaXNwbGF5PSIxIiBpc0ZpeGVkRHVyYXRpb249ImZhbHNlIiBpc0Nsb3NlZD0idHJ1ZSIgZGVmYXVsdER1cmF0aW9uPSIxMDAwIiAvPg0KICAgICAgPHN0YXRlIGRpc3BsYXk9IjMiIGlzRml4ZWREdXJhdGlvbj0iZmFsc2UiIGlzQ2xvc2VkPSJmYWxzZSIgZGVmYXVsdER1cmF0aW9uPSI1MDAwIiAvPg0KICAgICAgPHN0YXRlIGRpc3BsYXk9IjQiIGlzRml4ZWREdXJhdGlvbj0idHJ1ZSIgaXNDbG9zZWQ9InRydWUiIGRlZmF1bHREdXJhdGlvbj0iMzAwMCIgLz4NCiAgICA8L3NpZ25hbHNlcXVlbmNlPg0KICA8L3NpZ25hbHNlcXVlbmNlcz4NCiAgPHNncz4NCiAgICA8c2cgaWQ9IjEiIG5hbWU9IiIgZGVmYXVsdFNpZ25hbFNlcXVlbmNlPSI3Ij4NCiAgICAgIDxkZWZhdWx0RHVyYXRpb25zPg0KICAgICAgICA8ZGVmYXVsdER1cmF0aW9uIGRpc3BsYXk9IjEiIGR1cmF0aW9uPSIxMDAwIiAvPg0KICAgICAgICA8ZGVmYXVsdER1cmF0aW9uIGRpc3BsYXk9IjMiIGR1cmF0aW9uPSI1MDAwIiAvPg0KICAgICAgICA8ZGVmYXVsdER1cmF0aW9uIGRpc3BsYXk9IjQiIGR1cmF0aW9uPSIzMDAwIiAvPg0KICAgICAgPC9kZWZhdWx0RHVyYXRpb25zPg0KICAgIDwvc2c+DQogICAgPHNnIGlkPSIyIiBuYW1lPSIiIGRlZmF1bHRTaWduYWxTZXF1ZW5jZT0iNyI+DQogICAgICA8ZGVmYXVsdER1cmF0aW9ucz4NCiAgICAgICAgPGRlZmF1bHREdXJhdGlvbiBkaXNwbGF5PSIxIiBkdXJhdGlvbj0iMTAwMCIgLz4NCiAgICAgICAgPGRlZmF1bHREdXJhdGlvbiBkaXNwbGF5PSIzIiBkdXJhdGlvbj0iNTAwMCIgLz4NCiAgICAgICAgPGRlZmF1bHREdXJhdGlvbiBkaXNwbGF5PSI0IiBkdXJhdGlvbj0iMzAwMCIgLz4NCiAgICAgIDwvZGVmYXVsdER1cmF0aW9ucz4NCiAgICA8L3NnPg0KICA8L3Nncz4NCiAgPGludGVyZ3JlZW5tYXRyaWNlcyAvPg0KICA8cHJvZ3M+DQogICAgPHByb2cgaWQ9IjEiIGN5Y2xldGltZT0iNjAwMDAiIHN3aXRjaHBvaW50PSIwIiBvZmZzZXQ9IjAiIGludGVyZ3JlZW5zPSIwIiBmaXRuZXNzPSIwLjAwMDAwMCIgdmVoaWNsZUNvdW50PSIwIiBuYW1lPSJTaWduYWwgcHJvZ3JhbSAxIj4NCiAgICAgIDxzZ3M+DQogICAgICAgIDxzZyBzZ19pZD0iMSIgc2lnbmFsX3NlcXVlbmNlPSI3Ij4NCiAgICAgICAgICA8Y21kcz4NCiAgICAgICAgICAgIDxjbWQgZGlzcGxheT0iMyIgYmVnaW49IjEwMDAiIC8+DQogICAgICAgICAgICA8Y21kIGRpc3BsYXk9IjEiIGJlZ2luPSIyODAwMCIgLz4NCiAgICAgICAgICA8L2NtZHM+DQogICAgICAgICAgPGZpeGVkc3RhdGVzPg0KICAgICAgICAgICAgPGZpeGVkc3RhdGUgZGlzcGxheT0iNCIgZHVyYXRpb249IjMwMDAiIC8+DQogICAgICAgICAgPC9maXhlZHN0YXRlcz4NCiAgICAgICAgPC9zZz4NCiAgICAgICAgPHNnIHNnX2lkPSIyIiBzaWduYWxfc2VxdWVuY2U9IjciPg0KICAgICAgICAgIDxjbWRzPg0KICAgICAgICAgICAgPGNtZCBkaXNwbGF5PSIzIiBiZWdpbj0iMzEwMDAiIC8+DQogICAgICAgICAgICA8Y21kIGRpc3BsYXk9IjEiIGJlZ2luPSI1NzAwMCIgLz4NCiAgICAgICAgICA8L2NtZHM+DQogICAgICAgICAgPGZpeGVkc3RhdGVzPg0KICAgICAgICAgICAgPGZpeGVkc3RhdGUgZGlzcGxheT0iNCIgZHVyYXRpb249IjMwMDAiIC8+DQogICAgICAgICAgPC9maXhlZHN0YXRlcz4NCiAgICAgICAgPC9zZz4NCiAgICAgIDwvc2dzPg0KICAgIDwvcHJvZz4NCiAgICA8cHJvZyBpZD0iMiIgY3ljbGV0aW1lPSI5MDAwMCIgc3dpdGNocG9pbnQ9IjAiIG9mZnNldD0iMCIgaW50ZXJncmVlbnM9IjAiIGZpdG5lc3M9IjAuMDAwMDAwIiB2ZWhpY2xlQ291bnQ9IjAiIG5hbWU9IlNpZ25hbCBwcm9ncmFtIDIiPg0KICAgICAgPHNncz4NCiAgICAgICAgPHNnIHNnX2lkPSIxIiBzaWduYWxfc2VxdWVuY2U9IjciPg0KICAgICAgICAgIDxjbWRzPg0KICAgICAgICAgICAgPGNtZCBkaXNwbGF5PSIzIiBiZWdpbj0iMTAwMCIgLz4NCiAgICAgICAgICAgIDxjbWQgZGlzcGxheT0iMSIgYmVnaW49IjQzMDAwIiAvPg0KICAgICAgICAgIDwvY21kcz4NCiAgICAgICAgICA8Zml4ZWRzdGF0ZXM+DQogICAgICAgICAgICA8Zml4ZWRzdGF0ZSBkaXNwbGF5PSI0IiBkdXJhdGlvbj0iMzAwMCIgLz4NCiAgICAgICAgICA8L2ZpeGVkc3RhdGVzPg0KICAgICAgICA8L3NnPg0KICAgICAgICA8c2cgc2dfaWQ9IjIiIHNpZ25hbF9zZXF1ZW5jZT0iNyI+DQogICAgICAgICAgPGNtZHM+DQogICAgICAgICAgICA8Y21kIGRpc3BsYXk9IjMiIGJlZ2luPSI0NjAwMCIgLz4NCiAgICAgICAgICAgIDxjbWQgZGlzcGxheT0iMSIgYmVnaW49Ijg3MDAwIiAvPg0KICAgICAgICAgIDwvY21kcz4NCiAgICAgICAgICA8Zml4ZWRzdGF0ZXM+DQogICAgICAgICAgICA8Zml4ZWRzdGF0ZSBkaXNwbGF5PSI0IiBkdXJhdGlvbj0iMzAwMCIgLz4NCiAgICAgICAgICA8L2ZpeGVkc3RhdGVzPg0KICAgICAgICA8L3NnPg0KICAgICAgPC9zZ3M+DQogICAgPC9wcm9nPg0KICA8L3Byb2dzPg0KICA8c3RhZ2VzIC8+DQogIDxpbnRlcnN0YWdlUHJvZ3MgLz4NCiAgPHN0YWdlUHJvZ3MgLz4NCiAgPGRhaWx5UHJvZ0xpc3RzPg0KICAgIDxkYWlseVByb2dMaXN0IGlkPSIxMDAwIiBuYW1lPSJEYWlseSBzaWduYWwgcHJvZ3JhbSBsaXN0IDEwMDAiPg0KICAgICAgPGRhaWx5UHJvZ0xpc3RJdGVtcz4NCiAgICAgICAgPGRhaWx5UHJvZ0xpc3RJdGVtIHRpbWU9IjAiIHByb2dfaWQ9IjEiIC8+DQogICAgICAgIDxkYWlseVByb2dMaXN0SXRlbSB0aW1lPSI5MDAwMDAiIHByb2dfaWQ9IjIiIC8+DQogICAgICA8L2RhaWx5UHJvZ0xpc3RJdGVtcz4NCiAgICA8L2RhaWx5UHJvZ0xpc3Q+DQogIDwvZGFpbHlQcm9nTGlzdHM+DQo8L3NjPg==')
SC.SetAttValue('ProgNo', 1000)

# Save and reopen the file to import it into inpx -> This procedure is not necessary in this case.
#Vissim.SaveNetAs(f'{path}\AfterImport.inpx')
#Vissim.LoadNet(f'{path}\AfterImport.inpx')

# Add Signal Heads
SH1 = Vissim.Net.SignalHeads.AddSignalHead(0, Vissim.Net.Links.ItemByKey(1).Lanes.ItemByKey(1), 80)
SH2 = Vissim.Net.SignalHeads.AddSignalHead(0, Vissim.Net.Links.ItemByKey(2).Lanes.ItemByKey(1), 80)
SH1.SetAttValue('SG', '1-1')
SH2.SetAttValue('SG', '1-2')

